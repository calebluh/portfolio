<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Map Editor</title>
  <style>
    body { font-family: sans-serif; }
    #map { display: grid; grid-template-columns: repeat(60, 20px); grid-auto-rows: 20px; gap: 1px; }
    .tile { width: 20px; height: 20px; border: 1px solid #ccc; box-sizing: border-box; cursor: pointer; }
    .selected { outline: 2px solid #f90; }
    #palette { margin-bottom: 10px; }
    .palette-tile { width: 20px; height: 20px; border: 2px solid #888; display: inline-block; margin-right: 5px; cursor: pointer; }
    .palette-selected { border: 2px solid #f90; }
    textarea { width: 100%; height: 120px; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Simple Map Editor</h2>
  <div id="palette"></div>
  <div style="margin-bottom:10px;">
    <label><input type="radio" name="tool" value="single" checked> Single Tile</label>
    <label><input type="radio" name="tool" value="fill"> Filled Rectangle</label>
    <label><input type="radio" name="tool" value="outline"> Rectangle Outline</label>
  </div>
  <div id="map"></div>
  <button id="exportBtn">Export as JS Array</button>
  <textarea id="output" readonly></textarea>
  <script>
    // Tile types and colors (replace with images if desired)
    // Tiles (0-6) and objects (7+)
    const tileTypes = [
      { id: 0, name: 'grass', img: 'assets/tiles/grass.png' },
      { id: 1, name: 'wall', img: 'assets/tiles/wall.png' },
      { id: 2, name: 'path', img: 'assets/tiles/path.png' },
      { id: 3, name: 'water', img: 'assets/tiles/water.png' },
      { id: 4, name: 'door', img: 'assets/tiles/door.png' },
      { id: 5, name: 'floor', img: 'assets/tiles/floor.png' },
      { id: 6, name: 'dock', img: 'assets/tiles/dock.png' },
      // Objects (sprites)
      { id: 7, name: 'bookshelf', img: 'assets/sprites/bookshelf.png' },
      { id: 8, name: 'fisher', img: 'assets/sprites/fisher.png' },
      { id: 9, name: 'mailbox', img: 'assets/sprites/mailbox.png' },
      { id: 10, name: 'npc-resume', img: 'assets/sprites/npc-resume.png' },
      { id: 11, name: 'npc-skills', img: 'assets/sprites/npc-skills.png' },
      { id: 12, name: 'pc', img: 'assets/sprites/pc.png' },
      { id: 13, name: 'player', img: 'assets/sprites/player.png' },
      { id: 14, name: 'resume-npc', img: 'assets/sprites/resume-npc.png' },
      { id: 15, name: 'server-rack', img: 'assets/sprites/server-rack.png' },
      { id: 16, name: 'server', img: 'assets/sprites/server.png' },
      { id: 17, name: 'server2', img: 'assets/sprites/server2.png' },
      { id: 18, name: 'trainer', img: 'assets/sprites/trainer.png' },
      { id: 19, name: 'vinyl-shelf', img: 'assets/sprites/vinyl-shelf.png' }
    ];
    const WIDTH = 60, HEIGHT = 45;
    // Use provided mapData as the initial map
    const mapData = [
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,1,5,12,5,15,16,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,1,5,5,5,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,1,5,5,5,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,5,5,5,1,0,0,0,0,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,1,5,5,5,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,5,5,5,1,0,0,0,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,1,5,5,5,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,5,5,5,1,0,0,0,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,1,1,1,4,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,5,5,14,1,0,0,0,0,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,1,1,1,1,0,0,0,0,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,9,0,0,0,0,0,0,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,8,3,3,3,3,3,3,3,3,3,0,0,0,0,2,2,2,0,0,0,0,0,0,0,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,6,6,6,3,3,3,3,3,3,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,3,3,3,3,3,3,3,3,3,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,3,3,3,3,3,3,3,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,2,2,2,3,3,3,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,3,3,3,3,3,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,3,3,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,11,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3],
      [0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3],
      [0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3],
      [0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,3,3,3,3],
      [0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3],
      [0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,3,3,3],
      [0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2],
      [0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2],
      [0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2],
      [0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,9,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
      [0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,1,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
      [0,0,0,0,0,0,0,0,0,0,2,2,2,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,1,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,1,1,4,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,1,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,5,5,5,5,5,5,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,10,5,5,5,5,5,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,5,5,5,5,5,5,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,5,5,5,5,5,5,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,1,1,4,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,7,5,5,5,19,1,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,5,5,5,5,5,4,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,5,5,5,5,5,1,5,5,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ];
    let map = mapData.map(row => row.slice());
    let selectedTile = 0;

    // Palette
    const paletteDiv = document.getElementById('palette');
    tileTypes.forEach(t => {
      const el = document.createElement('div');
      el.className = 'palette-tile' + (t.id === selectedTile ? ' palette-selected' : '');
      el.title = t.name;
      const img = document.createElement('img');
      img.src = t.img;
      img.alt = t.name;
      img.style.width = '20px';
      img.style.height = '20px';
      el.appendChild(img);
      el.onclick = () => {
        selectedTile = t.id;
        document.querySelectorAll('.palette-tile').forEach(e => e.classList.remove('palette-selected'));
        el.classList.add('palette-selected');
      };
      paletteDiv.appendChild(el);
    });

    // Map grid with tool selection
    const mapDiv = document.getElementById('map');
    let tool = 'single';
    let dragStart = null;
    document.querySelectorAll('input[name="tool"]').forEach(radio => {
      radio.onchange = (e) => { tool = e.target.value; };
    });

    function renderMap() {
      mapDiv.innerHTML = '';
      for (let y = 0; y < HEIGHT; y++) {
        for (let x = 0; x < WIDTH; x++) {
          const tile = document.createElement('div');
          tile.className = 'tile';
          tile.title = tileTypes[map[y][x]] ? tileTypes[map[y][x]].name + ` (${x},${y})` : `(${x},${y})`;
          const img = document.createElement('img');
          img.src = tileTypes[map[y][x]] ? tileTypes[map[y][x]].img : '';
          img.alt = tileTypes[map[y][x]] ? tileTypes[map[y][x]].name : '';
          img.style.width = '20px';
          img.style.height = '20px';
          tile.appendChild(img);
          tile.onmousedown = (e) => {
            e.preventDefault();
            if (tool === 'single') {
              if (e.button === 2) {
                map[y][x] = 0; // right click erase
              } else {
                map[y][x] = selectedTile;
              }
              renderMap();
            } else {
              dragStart = {x, y, button: e.button};
            }
          };
          tile.onmouseup = (e) => {
            if (dragStart) {
              const x0 = Math.min(dragStart.x, x), x1 = Math.max(dragStart.x, x);
              const y0 = Math.min(dragStart.y, y), y1 = Math.max(dragStart.y, y);
              const value = dragStart.button === 2 ? 0 : selectedTile;
              if (tool === 'fill') {
                for (let yy = y0; yy <= y1; yy++) {
                  for (let xx = x0; xx <= x1; xx++) {
                    map[yy][xx] = value;
                  }
                }
              } else if (tool === 'outline') {
                for (let xx = x0; xx <= x1; xx++) {
                  map[y0][xx] = value;
                  map[y1][xx] = value;
                }
                for (let yy = y0+1; yy < y1; yy++) {
                  map[yy][x0] = value;
                  map[yy][x1] = value;
                }
              }
              dragStart = null;
              renderMap();
            }
          };
          tile.oncontextmenu = (e) => { e.preventDefault(); };
          mapDiv.appendChild(tile);
        }
      }
    }
    renderMap();

    // Export
    document.getElementById('exportBtn').onclick = () => {
      const arr = map.map(row => '[' + row.join(',') + ']').join(',\n  ');
      document.getElementById('output').value = 'const mapData = [\n  ' + arr + '\n];';
    };
  </script>
</body>
</html>
